# 数据导入使用指南

本系统支持多种数据导入方式，旨在满足不同场景下的需求。您可以选择最适合您工作流程的方案。

---

## 导入方案概览

1.  **批量导入 (Excel 多工作表)**
    - **最推荐**的方式，可一次性导入产品、供应商和订单数据。
    - **优点**：效率最高，适合初始化系统或大量数据录入。

2.  **单个文件导入 (CSV / Excel)**
    - 一次导入一种数据类型（例如，仅导入订单数据）。
    - **优点**：操作简单，适合小批量、分步更新数据。

3.  **飞书多维表格集成**
    - 与飞书实时同步数据。
    - **优点**：便于团队协作，自动化程度高。

--- 

## 📊 方案一：批量导入 (Excel 多工作表)

此方案允许您通过一个包含三个工作表的 Excel 文件，一次性导入所有核心数据。

### 1. Excel 文件结构要求

您的 Excel 文件必须包含 **3 个工作表 (Sheet)**，名称和内容必须严格遵循以下规范：

#### Sheet1: 产品/服务数据
- **工作表名称**: `Sheet1`
- **字段**: `服务名称`, `供应商名称`, `平日单价`, `服务类型`, `付款方式`

| 服务名称 | 供应商名称 | 平日单价 | 服务类型 | 付款方式 |
|---|---|---|---|---|
| 桂林导游服务 | 桂林漓江旅行社 | 1280 | 导游 | 定金50%+尾款50% |

#### Sheet2: 供应商数据
- **工作表名称**: `Sheet2`
- **字段**: `供应商名称`, `供应商类型`, `联系人`, `联系电话`

| 供应商名称 | 供应商类型 | 联系人 | 联系电话 |
|---|---|---|---|
| 桂林漓江旅行社 | 地接社 | 刘经理 | 0773-1234567 |

#### Sheet3: 订单数据
- **工作表名称**: `Sheet3`
- **字段**: `订单ID`, `客户名称`, `订单名称`, `出发日期`, `关联的服务`

| 订单ID | 客户名称 | 订单名称 | 出发日期 | 关联的服务 |
|---|---|---|---|---|
| ORD-2025-001 | 李先生 | 李先生-桂林4日游 | 2025-10-25 | 桂林导游服务,漓江景区门票 |

**重要**: `关联的服务` 字段中的服务名称必须与 Sheet1 中的 `服务名称` 完全一致，多个服务用**英文逗号**分隔。

### 2. 使用步骤

1.  **准备 Excel 文件**：按照上述要求创建并填写 `Sheet1`, `Sheet2`, `Sheet3`。
2.  **打开付款追踪系统**。
3.  点击 **"数据导入"** 按钮。
4.  选择 **"批量导入（多工作表）"** 模式。
5.  上传您准备好的 Excel 文件。
6.  系统将自动处理并显示导入结果。

---

## 📋 方案二：单个文件导入 (CSV / Excel)

此方案适合更新单一类型的数据。

### 使用步骤

1.  点击 **"数据导入"** 按钮。
2.  **选择数据类型**：订单 / 产品 / 供应商。
3.  选择 **"文件上传"** 方式。
4.  **下载模板**并按照格式填写数据。
5.  上传文件。

--- 

## 🚀 方案三：飞书多维表格集成

此方案可实现数据与飞书的实时同步，适合团队协作。

### 前置准备

1.  **创建飞书应用**：访问 [飞书开放平台](https://open.feishu.cn/app)，创建企业自建应用，获取 **App ID** 和 **App Secret**。
2.  **配置权限**：为应用添加 `bitable:app` 权限。
3.  **创建多维表格**：按照数据格式要求创建三个数据表，并从浏览器地址栏获取 `app_token` 和 `table_id`。
4.  **授权应用**：在多维表格的高级设置中，添加您创建的应用。

### 使用步骤

1.  点击 **"数据导入"** 按钮。
2.  选择 **"飞书多维表格"** 方式。
3.  填写 **App ID**, **App Secret**, **App Token**, 和 **Table ID**。
4.  点击 **"从飞书导入"**。

---

## ⚠️ 通用注意事项

- **数据一致性**: 跨表引用的**供应商名称**和**服务名称**必须完全一致。
- **日期格式**: 统一使用 `YYYY-MM-DD` 格式 (如 `2025-10-25`)。
- **数字格式**: 单价等字段必须是纯数字，不要包含货币符号或千分位分隔符。

---

## 📞 技术支持

如遇问题，请优先检查 Excel/CSV 文件格式是否符合要求，或查看浏览器控制台的详细错误信息。

**版本**：v1.1  
**更新日期**：2025-10-26
